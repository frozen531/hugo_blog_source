---
title: "06_指针"
date: 2023-03-05T21:22:07+08:00
draft: true
tags: ["C和指针"]
categories: ["读书笔记"]
---

# 指针

## 1. 值和类型

- 在内存中以```0```，```1```序列存放数值，可以被解释为各种类型
- 一个值的类型取决于它的使用方式

## 2. 内存、地址和变量

- 内存中每个位置都有唯一的地址标识
- 高级语言特性之一是：用名字代替地址，**通过名字而不是地址来访问内存的位置**
- 名字与内存位置之间的关联由编译器实现；硬件通过地址访问内存位置

![地址与名字](../00_picture/地址与名字.png)

- 一个变量的值就是分配给该变量的内存位置所存储的数值
- 变量既是左值也是右值：
> - 作为右值：表达式的值
> - 作为左值：内存地址而不是该地址所包含的值

## 3. 指针

### 🏹3.1 类型说明

```c
int a = -1;
int *b = &a;
int **c = &b;

*b = 10 - *b;
b = 10 - *b; // 错误，类型不匹配
```

表达式 | 类型 | 相当的表达式 | 左值 | 右值
:---: | :---: | :---: | :---: | :---:
```a``` | ```int``` | ```-1``` | Y | Y
```b``` | ```int *``` | ```&a``` | Y | Y
```*b``` | ```int``` | ```12, a``` | Y | Y
```c``` | ```int **``` | ```&b``` | Y | Y
```*c``` | ```int *``` | ```b, &a``` | Y | Y
```**c``` | ```int``` | ```-1, a, *b``` | Y | Y
```&a``` | |  | N | Y
```&b``` | |  | N | Y

- ```&a```和```&b```之所以不是左值，是因为它是表达式，存在计算结果，但是不知道该结果存放于哪个位置处
- ```*```为少数几个其结果为左值的操作符之一

### 🏹3.2 指定内存地址读/写

```c
*100 = 25; // 错误，*（间接访问操作符）只作用于指针类型表达式，类型不符合
*(int *)100 = 25;
```

- 当访问硬件本身，如操作系统需要与输入输出设备控制器通信，启动I/O操作时，对特定地址写入和读取数据，通常将这特定地址称为端口

### 🏹3.3 未初始化的指针和NULL

#### 未初始化的非法指针
```c
int *a;
...
*a = 12; // 未初始化的指针
```

- 声明一个指向整型的指针并不会创建用于存储整型值的内存空间
- 上例中并不知道12存储在哪里，a的初始值为自动的
> 1. 若a的初始值为非法地址：赋值将出错
> 2. 若a的初始值为合法地址：覆盖地址中的值，造成不可预料的错误

#### NULL

- NULL表示指针目前并未指向任何东西
- 对一个NULL指针进行解引用操作是非法的

### 🏹3.4 指针运算

- 指针 +/- 整数
> 指针在数组中移动
- 标准允许：
> 指向数组元素的指针与数组最后一个元素后面那个内存位置的指针进行比较<br>
> 但不允许与数组第1个元素之前的那个内存位置的指针进行比较
- 指针 - 指针
> 两个指针间的距离，相减结果类型为```ptrdiff_t```，是有符号整数类型
- 关系运算
> ```< <= > >=```<br>
> 前提：指向同一个数组中元素


